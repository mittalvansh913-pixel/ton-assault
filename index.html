<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TON ASSAULT</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:#0f2027;
  color:#fff;
}
.hidden{display:none}

/* TOP BAR */
#topbar{
  display:flex;
  justify-content:space-between;
  padding:12px 16px;
  background:#000;
}
.icon{
  font-size:22px;
  cursor:pointer;
}

/* MAIN */
#main{
  text-align:center;
  padding:30px;
}
#coin{
  width:160px;
  height:160px;
  border-radius:50%;
  background:radial-gradient(circle,#ffd54f,#ff9800);
  margin:40px auto;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:42px;
}
#coin:active{transform:scale(0.95)}

.stats{
  font-size:18px;
}

/* MODAL */
.modal{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,0.7);
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:5;
}
.box{
  background:#203a43;
  padding:20px;
  border-radius:14px;
  width:85%;
  max-width:300px;
  text-align:center;
}
button{
  padding:10px 18px;
  border:none;
  border-radius:10px;
  background:#ff9800;
  font-weight:bold;
  margin-top:10px;
}

/* SPIN WHEEL */
#wheel{
  width:200px;
  height:200px;
  border-radius:50%;
  border:6px solid #fff;
  margin:10px auto;
  background:conic-gradient(
    #ff9800 0deg 60deg,
    #ffd54f 60deg 120deg,
    #ff5722 120deg 180deg,
    #4caf50 180deg 240deg,
    #03a9f4 240deg 300deg,
    #e91e63 300deg 360deg
  );
}
#pointer{font-size:22px}
</style>
</head>

<body>

<!-- TOP -->
<div id="topbar">
  <div class="icon" onclick="openProfile()">üë§</div>
  <div class="icon" onclick="openDaily()">üéÅ</div>
  <div class="icon" onclick="openSpin()">üé°</div>
  <div class="icon" onclick="withdraw()">‚öôÔ∏è</div>
</div>

<!-- MAIN -->
<div id="main">
  <h2 id="playerName">Player</h2>
  <div id="coin" onclick="tap()">ü™ô</div>
  <div class="stats">
    Coins: <b id="coins">0</b><br>
    Level: <b id="level">1</b>
  </div>
</div>

<!-- PROFILE -->
<div id="profile" class="modal hidden">
  <div class="box">
    <h3>Profile</h3>
    <input id="nameInput" placeholder="Enter name" style="width:90%;padding:8px">
    <button onclick="saveName()">SAVE</button>
    <button onclick="closeAll()">CLOSE</button>
  </div>
</div>

<!-- DAILY -->
<div id="daily" class="modal hidden">
  <div class="box">
    <h3>Daily Reward</h3>
    <p>üéÅ +50 Coins</p>
    <button onclick="claimDaily()">CLAIM</button>
    <button onclick="closeAll()">CLOSE</button>
  </div>
</div>

<!-- SPIN -->
<div id="spin" class="modal hidden">
  <div class="box">
    <div id="pointer">‚¨ÜÔ∏è</div>
    <div id="wheel"></div>
    <button onclick="spin()">SPIN</button>
    <p id="spinMsg"></p>
    <button onclick="closeAll()">CLOSE</button>
  </div>
</div>

<script>
const tg=window.Telegram?.WebApp;
if(tg){tg.expand();tg.ready();}

let coins=0,level=1;
let name=localStorage.getItem("name")||"Player";
let lastDaily=localStorage.getItem("daily")||0;

playerName.textContent=name;

function update(){
  coinsEl.textContent=coins;
  levelEl.textContent=level;
}
const coinsEl=document.getElementById("coins");
const levelEl=document.getElementById("level");

/* TAP */
function tap(){
  coins+=level;
  if(coins>=level*50) level++;
  update();
}

/* PROFILE */
function openProfile(){closeAll();profile.classList.remove("hidden")}
function saveName(){
  name=nameInput.value||"Player";
  localStorage.setItem("name",name);
  playerName.textContent=name;
  closeAll();
}

/* DAILY */
function openDaily(){closeAll();daily.classList.remove("hidden")}
function claimDaily(){
  const now=Date.now();
  if(now-lastDaily<86400000){alert("Come tomorrow");return;}
  coins+=50;
  lastDaily=now;
  localStorage.setItem("daily",now);
  update();
  closeAll();
}

/* SPIN */
function openSpin(){closeAll();spin.classList.remove("hidden")}
function spin(){
  const deg=1080+Math.random()*360;
  wheel.style.transition="3s";
  wheel.style.transform="rotate("+deg+"deg)";
  setTimeout(()=>{
    const rewards=[5,10,20,50];
    const r=rewards[Math.floor(Math.random()*rewards.length)];
    coins+=r;
    spinMsg.textContent="You won "+r+" coins";
    update();
  },3000);
}

/* WITHDRAW */
function withdraw(){
  alert("Withdraw demo\nMin 2 coins\nFee 50%");
}

/* CLOSE ALL MODALS */
function closeAll(){
  document.querySelectorAll(".modal").forEach(m=>m.classList.add("hidden"));
}

/* ENSURE CLEAN START */
document.addEventListener("DOMContentLoaded",()=>{closeAll();update();});
</script>

</body>
</html>
